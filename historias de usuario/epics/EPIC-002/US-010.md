# US-010: Marcaje de campos erróneos del formulario

## ID
US-010

## Título
Marcaje de campos erróneos del formulario

## Como
Funcionario tramitador

## Quiero
Poder marcar los campos erróneos de la solicitud

## Para
Enviarle el requerimiento de subsanación al ciudadano y que corrija estos mismos campos marcados

## Descripción funcional

El sistema abre la solicitud original cumplimentada por el ciudadano posicionándose automáticamente en el paso 2 - Datos Específicos. Los componentes y campos del paso 2 se muestran deshabilitados (modo lectura). El tramitador puede marcar o desmarcar haciendo clic sobre cada campo o componente para indicar qué elementos son erróneos. El marcado de un componente o campo se resalta en otro color para distinguirlo visualmente. 

Existe un botón "Guardar" que permite almacenar la lista de campos a subsanar. Esta información se guarda de manera que posteriormente los campos marcados aparezcan resaltados y habilitados al ciudadano en la acción telemática de subsanación para su corrección.

No es posible navegar entre el resto de pasos de la solicitud (adelante y atrás). Se puede marcar y desmarcar un componente o campo tantas veces como sea necesario. La botonera inferior solo muestra los botones "Guardar" y "Cancelar". El funcionario puede entrar y modificar cuantas veces quiera los campos marcados.

## Flujo principal

1. Tramitador accede a solicitud para marcar campos erróneos
2. Sistema abre solicitud posicionándose automáticamente en paso 2 - Datos Específicos
3. Sistema muestra todos los campos y componentes en modo lectura (read-only)
4. Tramitador hace clic sobre campo o componente para marcarlo como erróneo
5. Sistema resalta visualmente el campo marcado en otro color
6. Tramitador puede hacer clic nuevamente sobre campo marcado para desmarcarlo
7. Tramitador repite el proceso para marcar todos los campos erróneos necesarios
8. Tramitador pulsa botón "Guardar"
9. Sistema almacena lista de campos marcados como erróneos asociada al expediente
10. Campos quedan registrados para ser presentados al ciudadano resaltados y habilitados en subsanación

## Criterios de aceptación

### Escenario 1: Acceso y visualización automática en paso 2

**Dado** una solicitud que requiere marcaje de campos erróneos  
**Cuando** el tramitador abre la solicitud desde el sistema  
**Entonces** el sistema posiciona automáticamente en el paso 2 - Datos Específicos  
**Y** todos los campos y componentes se muestran en modo lectura  
**Y** no es posible navegar hacia otros pasos de la solicitud

### Escenario 2: Marcado y desmarcado de campos erróneos

**Dado** el paso 2 - Datos Específicos visible en modo lectura  
**Cuando** el tramitador hace clic sobre un campo o componente  
**Entonces** el sistema marca el campo como erróneo  
**Y** el campo se resalta visualmente en otro color  
**Y** el cambio se refleja inmediatamente sin recargar la página  
**Cuando** el tramitador hace clic nuevamente sobre el campo marcado  
**Entonces** el sistema desmarca el campo  
**Y** el resaltado visual desaparece

### Escenario 3: Funcionalidad del botón Guardar

**Dado** campos marcados como erróneos en el formulario  
**Cuando** el tramitador pulsa el botón "Guardar"  
**Entonces** el sistema almacena la lista de campos marcados  
**Y** los campos quedan registrados para ser presentados al ciudadano resaltados y habilitados en subsanación  
**Y** el tramitador puede volver a entrar y modificar la selección posteriormente

### Escenario 4: Persistencia y edición de campos marcados

**Dado** campos previamente marcados y guardados  
**Cuando** el tramitador vuelve a abrir la solicitud  
**Entonces** el sistema muestra los campos previamente marcados con el resaltado visual  
**Y** el tramitador puede añadir nuevas marcas  
**Y** el tramitador puede quitar marcas existentes  
**Y** el tramitador puede guardar los cambios tantas veces como necesite

### Escenario 5: Restricciones de la interfaz

**Dado** la solicitud abierta para marcar campos erróneos  
**Cuando** el tramitador visualiza la botonera inferior  
**Entonces** solo aparecen los botones "Guardar" y "Cancelar"  
**Y** no existen botones de navegación entre pasos  
**Y** no es posible acceder al resto de pasos de la solicitud

### Escenario 6: Validaciones y guardado

**Dado** el formulario sin ningún campo marcado  
**Cuando** el tramitador pulsa "Guardar"  
**Entonces** el sistema permite guardar lista vacía sin producir error  
**Dado** campos marcados previamente guardados  
**Cuando** el tramitador guarda repetidamente  
**Entonces** no se produce ningún error  
**Y** el resaltado visual permanece consistente en todas las sesiones

---

*Historia creada: 27/01/2026*  
*Última actualización: 28/01/2026*
