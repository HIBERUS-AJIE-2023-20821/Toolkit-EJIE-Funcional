# US-016: Presentación y visualización de autorizaciones

**Épica:** [EPIC-006](EPIC-006.md) - Autorizaciones de consulta de datos

## Historia de usuario
**Como** ciudadano que tramita una solicitud  
**Quiero** ver claramente qué datos puede consultar la Administración y responder de manera sencilla si autorizo la consulta  
**Para** tomar decisiones informadas sobre mis autorizaciones y poder ajustarlas posteriormente

## Descripción funcional
En el paso de autorizaciones, el sistema presenta primero una **pregunta global** que facilita la decisión del ciudadano: "¿Autorizas a la Administración a consultar tus datos?" con dos opciones (Sí/No) mediante radiobutton.

Debajo de esta pregunta global aparecen dos bloques **deshabilitados inicialmente**:
1. **Bloque "Datos salvo oposición"**: Datos cuya consulta está autorizada por defecto, pero el ciudadano puede oponerse
2. **Bloque "Datos únicamente si consiente"**: Datos que requieren autorización explícita

Cada bloque incluye:
- Un **switch general** que afecta a todos los datos del bloque
- Un **checkbox individual** por cada dato que se puede consultar
- Información del **organismo cedente** de cada dato

La respuesta a la pregunta global habilita ambos bloques y preselecciona los checkboxes según la decisión inicial, permitiendo después ajustes selectivos.

## Criterios de aceptación

### CA-1: Visualización de pregunta global
**Dado** que el ciudadano accede al paso de autorizaciones  
**Cuando** se carga la pantalla  
**Entonces** debe visualizar la pregunta "¿Autorizas a la Administración a consultar tus datos?" con dos opciones mediante radiobutton: "Sí" y "No"

### CA-2: Bloques deshabilitados inicialmente
**Dado** que el ciudadano accede al paso de autorizaciones por primera vez  
**Cuando** se carga la pantalla  
**Entonces** los dos bloques (salvo oposición y únicamente si consiente) deben aparecer deshabilitados sin permitir interacción

### CA-3: Visualización de bloques
**Dado** que se muestra el paso de autorizaciones  
**Cuando** se cargan los bloques  
**Entonces** debe visualizar:
- Bloque 1: "Datos salvo oposición" con switch general y checkbox por cada dato
- Bloque 2: "Datos únicamente si consiente" con switch general y checkbox por cada dato
- Para cada dato: descripción clara y organismo cedente

### CA-4: Respuesta SÍ a pregunta global
**Dado** que los bloques están deshabilitados  
**Cuando** el ciudadano selecciona "Sí" en la pregunta global  
**Entonces** el sistema debe:
- Habilitar ambos bloques permitiendo interacción
- Desmarcar TODOS los checkboxes del bloque "salvo oposición" (NO se opone)
- Marcar TODOS los checkboxes del bloque "únicamente si consiente" (autoriza todos)
- Ajustar los switches generales según corresponda

### CA-5: Respuesta NO a pregunta global
**Dado** que los bloques están deshabilitados  
**Cuando** el ciudadano selecciona "No" en la pregunta global  
**Entonces** el sistema debe:
- Habilitar ambos bloques permitiendo interacción
- Marcar TODOS los checkboxes del bloque "salvo oposición" (se opone a todos)
- Desmarcar TODOS los checkboxes del bloque "únicamente si consiente" (no autoriza ninguno)
- Ajustar los switches generales según corresponda

### CA-6: Sin autorizaciones configuradas
**Dado** que el procedimiento no tiene autorizaciones configuradas  
**Cuando** el ciudadano accede al paso de autorizaciones  
**Entonces** el sistema debe omitir este paso y continuar con el siguiente

### CA-7: Cambio de respuesta global
**Dado** que el ciudadano ya ha respondido a la pregunta global  
**Cuando** cambia su respuesta (de Sí a No o viceversa)  
**Entonces** el sistema debe recalcular todos los checkboxes según la nueva selección

### CA-8: Visualización de organismo cedente por dato
**Dado** que se muestra la lista de datos a consultar en cualquier bloque  
**Cuando** el ciudadano visualiza cada dato  
**Entonces** debe aparecer claramente:
- Nombre o descripción del dato
- Organismo cedente que proporciona el dato

### CA-9: Todos los datos con cedente visible
**Dado** que se presentan los bloques de autorizaciones  
**Cuando** el sistema muestra los datos a consultar  
**Entonces** cada dato debe indicar su organismo cedente de forma visible
