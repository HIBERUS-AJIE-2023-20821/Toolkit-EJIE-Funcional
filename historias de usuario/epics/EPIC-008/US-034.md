# US-034: Completado de declaraciones según configuración CCP

**Épica:** [EPIC-008](EPIC-008.md) - Subsanación - Proceso del Ciudadano

## Historia de usuario
**Como** ciudadano en subsanación  
**Quiero** aceptar las declaraciones responsables requeridas según la configuración de subsanación  
**Para** cumplir con los requisitos legales del proceso

## Descripción funcional
El paso de declaraciones responsables se carga según la configuración del CCP (Catálogo de Configuración de Procedimientos) específica para la acción telemática de subsanación. Este paso presenta las declaraciones que el ciudadano debe revisar y aceptar.

No se muestran ni precargan las declaraciones de la solicitud original. El ciudadano debe aceptar las declaraciones específicas configuradas para el proceso de subsanación.

Las declaraciones configuradas pueden:
- Ser obligatorias u opcionales
- Estar condicionadas a valores introducidos en el paso 2
- Requerir aceptación explícita

El ciudadano debe leer cada declaración y marcar su aceptación explícitamente. Las declaraciones obligatorias bloquean el avance si no son aceptadas. El sistema registra la aceptación con trazabilidad completa.

## Flujo principal
1. Ciudadano completa modificaciones en pasos anteriores
2. Ciudadano accede al paso de declaraciones
3. Sistema evalúa condicionamientos de declaraciones
4. Sistema identifica declaraciones afectadas por cambios
5. Sistema habilita declaraciones condicionadas según nuevas condiciones
6. Sistema muestra texto de cada declaración habilitada
7. Ciudadano lee y acepta declaraciones obligatorias
8. Sistema registra aceptación con trazabilidad
9. Sistema valida que declaraciones obligatorias estén aceptadas

## Criterios de aceptación

### Escenario 1: Evaluación de declaraciones condicionadas

**Dado** que el ciudadano accede al paso de declaraciones  
**Cuando** el sistema evalúa condicionamientos  
**Entonces** el sistema identifica declaraciones condicionadas a campos modificados  
**Y** habilita las declaraciones que cumplen las nuevas condiciones

### Escenario 2: Declaración se vuelve obligatoria por cambio

**Dado** que un campo modificado condiciona una declaración  
**Cuando** el nuevo valor cumple la condición  
**Entonces** el sistema muestra la declaración como obligatoria  
**Y** requiere aceptación explícita  
**Y** bloquea avance si no se acepta

### Escenario 3: Declaración deja de ser obligatoria

**Dado** que una declaración era obligatoria previamente  
**Cuando** los cambios hacen que no cumpla condiciones  
**Entonces** el sistema no la presenta como obligatoria  
**Y** mantiene registro histórico de aceptación anterior  
**Y** no requiere nueva aceptación

### Escenario 4: Aceptación explícita de declaración

**Dado** que una declaración está habilitada  
**Cuando** el ciudadano marca su aceptación  
**Entonces** el sistema registra la aceptación  
**Y** incluye marca temporal  
**Y** registra datos del ciudadano aceptante

### Escenario 5: Validación de declaraciones obligatorias

**Dado** que hay declaraciones obligatorias sin aceptar  
**Cuando** el ciudadano intenta avanzar  
**Entonces** el sistema bloquea el avance  
**Y** muestra mensaje indicando declaraciones pendientes  
**Y** resalta visualmente las no aceptadas

### Escenario 6: Texto variable según condiciones

**Dado** que una declaración tiene texto variable  
**Cuando** el sistema la presenta  
**Entonces** el texto se adapta a los valores introducidos  
**Y** muestra información coherente con los datos  
**Y** mantiene claridad legal del contenido

### Escenario 7: Declaraciones no condicionadas

**Dado** que existen declaraciones no condicionadas en la solicitud  
**Cuando** el ciudadano accede al paso de declaraciones  
**Entonces** las declaraciones no condicionadas mantienen su estado original  
**Y** no se solicita nueva aceptación en subsanación  
**Y** se muestran como previamente aceptadas si aplicaba

### Escenario 8: Múltiples declaraciones por condicionamiento complejo

**Dado** que varias declaraciones están condicionadas a múltiples campos  
**Cuando** se evalúan las combinaciones de valores  
**Entonces** el sistema aplica correctamente todas las reglas  
**Y** habilita el conjunto correcto de declaraciones  
**Y** indica correctamente la obligatoriedad de cada una

---

*Historia creada: 29/01/2026*
