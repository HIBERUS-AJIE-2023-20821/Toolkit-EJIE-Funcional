# US-033: Completado de documentos según configuración CCP

**Épica:** [EPIC-008](EPIC-008.md) - Subsanación - Proceso del Ciudadano

## Historia de usuario
**Como** ciudadano en subsanación  
**Quiero** cargar los documentos requeridos según la configuración de subsanación  
**Para** completar la documentación necesaria para mi expediente

## Descripción funcional
El paso de documentos se carga según la configuración del CCP (Catálogo de Configuración de Procedimientos) específica para la acción telemática de subsanación. Este paso se presenta vacío y el ciudadano debe completarlo con los documentos requeridos según lo indicado en el documento de requerimiento adjunto a la notificación.

No se muestran ni precargan los documentos de la solicitud original. El ciudadano debe incluir aquellos documentos que se le hayan solicitado subsanar específicamente.

Los documentos configurados pueden:
- Ser obligatorios u opcionales según configuración
- Estar condicionados a valores introducidos en el paso 2
- Tener restricciones de formato y tamaño
- Permitir múltiples archivos o archivo único

El ciudadano selecciona archivos desde su dispositivo, el sistema valida formato y tamaño, y almacena los documentos en Dokusi relacionándolos con la subsanación.

## Flujo principal
1. Ciudadano completa modificaciones en paso de datos específicos
2. Ciudadano accede al paso de documentos
3. Sistema evalúa condicionamientos de documentos
4. Sistema identifica documentos afectados por cambios realizados
5. Sistema habilita documentos condicionados según nuevas condiciones
6. Sistema indica obligatoriedad de cada documento habilitado
7. Ciudadano carga documentos habilitados
8. Sistema valida formato y tamaño
9. Sistema almacena documentos en Dokusi relacionados con subsanación

## Criterios de aceptación

### Escenario 1: Evaluación de documentos condicionados

**Dado** que el ciudadano accede al paso de documentos  
**Cuando** el sistema evalúa condicionamientos  
**Entonces** el sistema identifica documentos condicionados a campos modificados  
**Y** habilita los documentos que cumplen las nuevas condiciones

### Escenario 2: Documento se vuelve obligatorio por cambio

**Dado** que un campo modificado condiciona un documento  
**Cuando** el nuevo valor cumple la condición  
**Entonces** el sistema muestra el documento como obligatorio  
**Y** indica que debe cargarse  
**Y** bloquea avance si no se aporta

### Escenario 3: Documento deja de ser obligatorio

**Dado** que un documento era obligatorio previamente  
**Cuando** los cambios hacen que no cumpla condiciones  
**Entonces** el sistema lo marca como opcional o lo oculta  
**Y** no requiere su carga  
**Y** puede mantener el documento previamente cargado si existe

### Escenario 4: Carga de documento habilitado

**Dado** que un documento está habilitado para carga  
**Cuando** el ciudadano selecciona archivo  
**Entonces** el sistema valida formato y tamaño  
**Y** almacena el documento en Dokusi  
**Y** lo relaciona con la subsanación

### Escenario 5: Validación de formatos permitidos

**Dado** que el ciudadano carga un documento  
**Cuando** el formato no es válido  
**Entonces** el sistema rechaza el archivo  
**Y** muestra mensaje indicando formatos permitidos  
**Y** permite reintentar con archivo correcto

### Escenario 6: Documentos no condicionados

**Dado** que existen documentos no condicionados en la solicitud  
**Cuando** el ciudadano accede al paso de documentos  
**Entonces** los documentos no condicionados mantienen su estado original  
**Y** no se habilita su modificación en subsanación  
**Y** se muestran en solo lectura si estaban cargados

### Escenario 7: Múltiples documentos por condicionamiento complejo

**Dado** que varios documentos están condicionados a múltiples campos  
**Cuando** se evalúan las combinaciones de valores  
**Entonces** el sistema aplica correctamente todas las reglas  
**Y** habilita el conjunto correcto de documentos  
**Y** indica correctamente la obligatoriedad de cada uno

---

*Historia creada: 29/01/2026*
